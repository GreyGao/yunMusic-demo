"use strict";function pageGo(e){$(".tabs-main").eq(e).addClass("active").siblings().removeClass("active"),$(".mainPage").eq(e).addClass("active").siblings().removeClass("active")}function inputChange(e){$(".resultMatch").addClass("hide"),$("#searchResults").addClass("hide"),$("#search-holder").text(""),$("#searchEmpty").removeClass("hide"),timer&&window.clearTimeout(timer),timer=setTimeout(function(){timer=null;var s=$(e.currentTarget).val(),n=new AV.Query("Song");n.contains("name",s);var t=new AV.Query("Song");t.contains("singer",s);var a=new AV.Query("Song");a.contains("album",s);var i=new AV.Query("Song");i.contains("des",s);var r=AV.Query.or(n,t,a,i);0===s.length?($("#search-holder").text("搜索歌曲、歌手、专辑"),$("#searchTips").removeClass("hide"),$("#searchEmpty").addClass("hide")):($("#searchResults").removeClass("hide"),$("#searchLink").text('搜索"'+s+'"'),$("#searchTips").addClass("hide"),$("#resultList").empty(),r.find().then(function(e){if($("#resultList").empty(),0===e.length){resultList.insertAdjacentHTML("beforeend",'\n                <a class="resultSong"><i class="svg svg-search"></i><span>没有结果</span></a>\n                ')}else for(var s=0;s<e.length;s++){var n=e[s].attributes,t="\n                <a href=/yunMusic-demo/play.html?id="+e[s].id+' class="resultSong">\n                <i class="svg svg-search"></i><span>'+n.name+" - "+n.singer+"</span></a>\n                ";resultList.insertAdjacentHTML("beforeend",t)}}))},350)}function hotSongLink(e){matchSongList($(e.currentTarget).text().trim())}function searchSubmit(e){matchSongList($(e.currentTarget).val()),$("#searchResults").addClass("hide")}function matchSongList(e){if(0!=e.length){$(".resultMatch").removeClass("hide"),$("#searchTips").addClass("hide");var s=document.querySelector("#matchSongList");$("input#searchSong").val(e),$("#search-holder").text(""),timer&&window.clearTimeout(timer),timer=setTimeout(function(){timer=null;var n=new AV.Query("Song");n.contains("name",e);var t=new AV.Query("Song");t.contains("singer",e);var a=new AV.Query("Song");a.contains("album",e);var i=new AV.Query("Song");i.contains("des",e),AV.Query.or(n,t,a,i).find().then(function(e){if(0===e.length){$("#matchSongList").empty(),$("#matchTitle").text("");s.insertAdjacentHTML("beforeend","<p>暂无搜索结果</p>")}else{$("#matchSongList").empty();for(var n=0;n<e.length;n++){var t=e[n].attributes,a="<a href=/yunMusic-demo/play.html?id="+e[n].id+' class="songInfo">\n                    <p class="songTitle">'+t.name+'<span class="songDesc">'+t.des+'</span></p>\n                    <p class="singer"><i class="icon icon-sq"></i>'+t.singer+" - "+t.album+'</p>\n                    <div class="playButton"><i class="icon icon-play"></i></div>\n                    </a>';s.insertAdjacentHTML("beforeend",a)}}})},350)}}$(".tabs").on("click",".tabs-main",function(e){pageGo($(e.currentTarget).index())}),AV.init({appId:"zKM1TH8kc8MSMoh0pd6NcUYY-gzGzoHsz",appKey:"SutiQq6E6jY1WAwkDOgK4RpB"});var resultList=document.querySelector("#resultList");$("input#searchSong").bind("input",function(e){inputChange(e)}).bind("focus",function(e){inputChange(e)}).bind("keypress",function(e){searchSubmit(e)}),$("#hotSearchList").on("click","li",function(e){hotSongLink(e)});var timer=null;$("#searchEmpty").on("click",function(){$("input#searchSong").val(""),$("#search-holder").text("搜索歌曲、歌手、专辑"),$("#searchTips").removeClass("hide"),$("#searchEmpty").addClass("hide"),$("#searchResults").addClass("hide"),$(".resultMatch").addClass("hide")});