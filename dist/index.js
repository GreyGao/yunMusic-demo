"use strict";function pageGo(e){$(".tabs-main").eq(e).addClass("active").siblings().removeClass("active"),$(".mainPage").eq(e).addClass("active").siblings().removeClass("active")}function loadSongs(){function e(e,n){return"\n            <a href=/yunMusic-demo/play.html?id="+n+' class="songInfo">\n                    <p class="songTitle">'+e.name+'<span class="songDesc">'+e.des+'</span></p>\n                    <p class="singer"><i class="icon icon-sq"></i>'+e.singer+" - "+e.album+'</p>\n                    <div class="playButton"><i class="icon icon-play"></i></div>\n             </a>\n        '}new AV.Query("Song").find().then(function(n){$("#loading-music").remove();for(var s=0;s<n.length;s++){var a=e(n[s].attributes,n[s].id);$("#newSongsList").append(a),$("#hotSongsList").append(a)}},function(e){alert("获取歌曲失败"+e)})}function inputChange(e){$(".resultMatch").addClass("hide"),$("#searchResults").addClass("hide"),$("#search-holder").text(""),$("#searchEmpty").removeClass("hide"),timer&&window.clearTimeout(timer),timer=setTimeout(function(){timer=null;var n=$(e.currentTarget).val(),s=new AV.Query("Song");s.contains("name",n);var a=new AV.Query("Song");a.contains("singer",n);var t=new AV.Query("Song");t.contains("album",n);var i=new AV.Query("Song");i.contains("des",n);var r=AV.Query.or(s,a,t,i);0===n.length?($("#search-holder").text("搜索歌曲、歌手、专辑"),$("#searchTips").removeClass("hide"),$("#searchEmpty").addClass("hide")):($("#searchResults").removeClass("hide"),$("#searchLink").text('搜索"'+n+'"'),$("#searchTips").addClass("hide"),$("#resultList").empty(),r.find().then(function(e){if($("#resultList").empty(),0===e.length){resultList.insertAdjacentHTML("beforeend",'\n                <a class="resultSong"><i class="svg svg-search"></i><span>没有结果</span></a>\n                ')}else for(var n=0;n<e.length;n++){var s=e[n].attributes,a="\n                <a href=/yunMusic-demo/play.html?id="+e[n].id+' class="resultSong">\n                <i class="svg svg-search"></i><span>'+s.name+" - "+s.singer+"</span></a>\n                ";resultList.insertAdjacentHTML("beforeend",a)}}))},350)}function hotSongLink(e){matchSongList($(e.currentTarget).text().trim())}function searchSubmit(e){matchSongList($(e.currentTarget).val()),$("#searchResults").addClass("hide")}function matchSongList(e){if(0!=e.length){$(".resultMatch").removeClass("hide"),$("#searchTips").addClass("hide");var n=document.querySelector("#matchSongList");$("input#searchSong").val(e),$("#search-holder").text(""),timer&&window.clearTimeout(timer),timer=setTimeout(function(){timer=null;var s=new AV.Query("Song");s.contains("name",e);var a=new AV.Query("Song");a.contains("singer",e);var t=new AV.Query("Song");t.contains("album",e);var i=new AV.Query("Song");i.contains("des",e),AV.Query.or(s,a,t,i).find().then(function(e){if(0===e.length){$("#matchSongList").empty(),$("#matchTitle").text("");n.insertAdjacentHTML("beforeend","<p>暂无搜索结果</p>")}else{$("#matchSongList").empty();for(var s=0;s<e.length;s++){var a=e[s].attributes,t="<a href=/yunMusic-demo/play.html?id="+e[s].id+' class="songInfo">\n                    <p class="songTitle">'+a.name+'<span class="songDesc">'+a.des+'</span></p>\n                    <p class="singer"><i class="icon icon-sq"></i>'+a.singer+" - "+a.album+'</p>\n                    <div class="playButton"><i class="icon icon-play"></i></div>\n                    </a>';n.insertAdjacentHTML("beforeend",t)}}})},350)}}$(".tabs").on("click",".tabs-main",function(e){pageGo($(e.currentTarget).index())}),AV.init({appId:"zKM1TH8kc8MSMoh0pd6NcUYY-gzGzoHsz",appKey:"SutiQq6E6jY1WAwkDOgK4RpB"}),loadSongs();var resultList=document.querySelector("#resultList");$("input#searchSong").bind("input",function(e){inputChange(e)}).bind("focus",function(e){inputChange(e)}).bind("keypress",function(e){searchSubmit(e)}),$("#hotSearchList").on("click","li",function(e){hotSongLink(e)});var timer=null;$("#searchEmpty").on("click",function(){$("input#searchSong").val(""),$("#search-holder").text("搜索歌曲、歌手、专辑"),$("#searchTips").removeClass("hide"),$("#searchEmpty").addClass("hide"),$("#searchResults").addClass("hide"),$(".resultMatch").addClass("hide")});