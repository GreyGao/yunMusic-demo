"use strict";function getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function musicPlayer(){var e=document.createElement("audio");e.id="songSrc",document.body.appendChild(e),e.play(),$("#playButton").on("click",function(){e.paused?(e.play(),$(".song-img").toggleClass("spin-run spin-stop"),$(".song-circle").toggleClass("spin-run spin-stop"),$("#songPin").toggleClass("pin-stop")):e.play()&&(e.pause(),$(".song-img").toggleClass("spin-run spin-stop"),$(".song-circle").toggleClass("spin-run spin-stop"),$("#songPin").toggleClass("pin-stop"))}),e.addEventListener("ended",function(){$(".song-img").toggleClass("spin-run spin-stop"),$(".song-circle").toggleClass("spin-run spin-stop"),$("#playButton").removeClass("hide"),$("#songPin").toggleClass("pin-stop")}),setInterval(function(){for(var t=e.currentTime,n=~~(t/60),s=t-60*n,a=pad(n)+":"+pad(s),i=$(".lines >p"),o=void 0,r=0;r<i.length;r++){var p=i.eq(r).attr("data-time"),g=i.eq(r+1).attr("data-time");0!==i.eq(r+1).length&&p<a&&g>a&&(o=i.eq(r))}if(o){o.addClass("active").prev().removeClass("active");var l=o.offset().top,c=$(".lines").offset().top,u=Math.floor(l-c-$(".song-lyric").height()/3);$(".lines").css("transform","translateY(-"+u+"px)")}},300)}function parseLyric(e){var t=e.split("\n"),n=/^\[(.+)\](.*)$/;t=t.map(function(e,t){var s=e.match(n);if(s)return{time:s[1],words:s[2]}});var s=$(".lines");t.map(function(e){if(e){var t=$("<p/>");t.attr("data-time",e.time).text(e.words),s.append(t)}})}function pad(e){return e>=10?e+"":"0"+e}var APP_ID="zKM1TH8kc8MSMoh0pd6NcUYY-gzGzoHsz",APP_KEY="SutiQq6E6jY1WAwkDOgK4RpB";AV.init({appId:APP_ID,appKey:APP_KEY});var id=getParameterByName("id"),query=new AV.Query("Song");query.get(id).then(function(e){var t=e.attributes,n=t.name,s=t.singer,a=t.image,i=t.url,o=t.lyric;$("title").html(n+"-"+s+"-在线试听"),$("#songCover").attr("src",a),$("#songName").text(n),$("#songSinger").text(s),$("#songSpace").text(" - "),$("#playBg").css("background","url("+a+") no-repeat").css("background-position","50%").css("background-size","auto 100%"),$("#songSrc").attr("src",i),parseLyric(o)}),musicPlayer();